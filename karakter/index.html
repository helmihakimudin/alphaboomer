<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Alphaboomer - Teman Edukatif</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(to bottom right, #FFFDE7, #E0F7FA);
      color: #444;
    }

    header {
      background-color: #FFF176;
      text-align: center;
      padding: 1.5rem;
      border-bottom: 4px solid #FFD54F;
    }

    header h1 {
      margin: 0;
      font-family: 'Fredoka One', cursive;
      font-size: 2.5rem;
      color: #039BE5;
    }

    .container {
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }

    #model-viewer {
      width: 100%;
      max-width: 500px;
      height: 400px;
      margin-bottom: 2rem;
      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    #judul {
      font-family: 'Fredoka One', cursive;
      color: #FFA000;
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    #desc {
      max-width: 600px;
      font-size: 1.1rem;
      background: #ffffff;
      padding: 1.5rem;
      border-radius: 16px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
      line-height: 1.6;
      white-space: pre-line;
    }

    .headfooter {
      margin-top: 4rem;
      background: #039BE5;
      text-align: center;
      padding: 1rem;
      font-size: 0.9rem;
      color: #ebebeb;
    }

    footer {
      background: #FFF9C4;
      text-align: center;
      padding: 1rem;
      font-size: 0.9rem;
      color: #999;
    }
  </style>
</head>

<body>
  <header>
    <h1>Teman Edukatif</h1>
    <small>by alphaboomer</small>
  </header>
  <div class="container">
    <div id="model-viewer">
      <model-viewer id="glbViewer" src="" alt="Karakter 3D" auto-rotate camera-controls background-color="#ffffff"
        style="width: 100%; height: 100%"></model-viewer>
    </div>

    <h2 id="judul">Memuat karakter...</h2>
    <div id="desc">Mohon tunggu sebentar.</div>
  </div>
  <div class="headfooter">
    <small>
      <em>"American_flamingo_obj"</em> by <a href="https://sketchfab.com/SAVIA_Colombia"
        target="_blank">SAVIA_Colombia</a>,
      licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
      Model: <a href="https://skfb.ly/ozCxv" target="_blank">Sketchfab</a>
    </small>
  </div>
  <footer>
    &copy; 2025 Teman Edukatif - Belajar Seru Bersama Karakter Lucu!
  </footer>

  <!-- 3D Viewer -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <script>
    const secretKey = "teman-edukatif-123";

    function decryptName(encryptedText) {
      try {
        const bytes = CryptoJS.AES.decrypt(decodeURIComponent(encryptedText), secretKey);
        const decrypted = bytes.toString(CryptoJS.enc.Utf8);
        return decrypted || null;
      } catch (error) {
        console.error("Decrypt Error:", error);
        return null;
      }
    }

    const params = new URLSearchParams(window.location.search);
    const encryptedName = params.get('name');

    const karakter = encryptedName ? decryptName(encryptedName) : null;

    if (karakter) {
      document.getElementById('glbViewer').src = `/karakter/model/${karakter}.glb`;

      fetch('/karakter/data/karakter.json')
        .then(res => res.json())
        .then(data => {
          const info = data[karakter];
          if (info) {
            document.getElementById('judul').textContent = info.title;
            document.getElementById('desc').textContent = info.deskripsi;
          } else {
            document.getElementById('judul').textContent = "Karakter tidak ditemukan";
            document.getElementById('desc').textContent = "Ups! Karakter yang kamu cari belum tersedia.";
          }
        })
        .catch(() => {
          document.getElementById('judul').textContent = "Gagal memuat data";
          document.getElementById('desc').textContent = "Silakan coba beberapa saat lagi.";
        });
    } else {
      document.getElementById('judul').textContent = "Link tidak valid";
      document.getElementById('desc').textContent = "Parameter tidak bisa didekripsi.";
    }
  </script>
</body>

</html>
